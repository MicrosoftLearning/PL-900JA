---
lab:
    title: 'ラボ 02: キャンバス アプリ、パート1'
    module: 'モジュール XX: Power Apps のビルド'
---

# PL-900: Microsoft-Power-Platform-Fundamentals
## モジュール X、ラボ 2 – キャンバス アプリ - パート 1

シナリオ
========

ベローズ カレッジは、キャンパス内に複数の建物を持つ教育機関です。キャンパス訪問は現在、紙の記録簿に記録されています。情報は一貫してキャプチャされず、キャンパス全体の訪問に関するデータを収集して分析する手段はありません。 

キャンパス管理は、建物へのアクセスがセキュリティ担当者によって制御され、すべての訪問がホストによって事前登録され、記録される必要がある訪問者登録システムを近代化したいと考えています。

このコースでは、アプリケーションを構築し、自動化を実行して、ベローズ カレッジの管理およびセキュリティ担当者がキャンパス内の建物へのアクセスを管理および制御できるようにします。  

このラボのパート 1 では、大学のスタッフがゲストの訪問を管理するために使用できる PowerApps キャンバスアプリを設計します。

ハイレベルのラボ手順
======================

キャンバス アプリを設計するには、以下の概要に従います。

-   電話フォーム ファクター テンプレートを使用してデータからアプリを作成します
-   訪問情報を含む詳細ページ
-   訪問に作成する編集ページ
-   訪問を表示するギャラリー コントロール
-   ギャラリー データ ソースにフィルタリングを追加して、今後の訪問のみを表示します

## 前提条件

* ラボ 1 の完了 - データ モデリング

始める前に考慮すべきこと
-----------------------------------

-   対象ユーザーに最も普及しているフォーム ファクター
-   システム内のレコード数を推定します 
-   アプリのパフォーマンスとユーザーの採用を向上させるために選択したレコードを絞り込む方法


演習 \#1: スタッフ キャンバス アプリの作成
===============================

**目標:** この演習では、テンプレートからキャンバス アプリを作成し、必要なデータを含むように変更します。

タスク \#1: キャンバス アプリを作成する
---------------------------

このタスクでは、 Common Data Service に基づく電話レイアウトテンプレートを使用してキャンバスアプリを作成します。CDS から選択したエンティティとして訪問を使用して、テンプレートは、キャンパス訪問を管理するギャラリー - 表示 - 編集アプリを生成します。

1.  「Campus Management」 ソリューションを開きます。

    -   <https://make.powerapps.com> にサインインします

    -   **環境**を選択します

    -   「**アプリ**」 を選択します

2.  新しいキャンバス アプリケーションを作成する

    -   「**新しいアプリ &#124; キャンバスアプリ**」 をクリックします。
    -   **Common Data Service** の下の 「**電話レイアウト**」 を選択します。 
-   **Common Data Service** 接続を選択し、「**作成**」 をクリックします。 
    -   **訪問**テーブルを選択してください
    -   **接続** をクリックする
3.  アプリケーションを保存します
    1.  「**ファイル」、「保存**」 の順にクリックします。
    2.  **キャンパス スタッフ**としてアプリの名前を入力します。
    3.  **「保存」** を押します。

タスク \#2: 訪問の詳細フォームを構成する
--------------------------------

このタスクでは、個々の訪問レコードに関する情報を表示する詳細フォームを構成します

1.  **ツリー ビュー**の下にある **DetailScreen1** を展開します
2.  **DetailForm1** を選択します。
3.  プロパティパネルで、「**フィールド**」 の横にある 「**編集**」 を選択します。
4.  「**フィールドの追加**」 をクリックします。
5.  次のフィールドを選択します。
    * 実際の終了
    * 実際の開始
    * 建物 
    * コード
    * 終了予定
    * 開始予定
    * 訪問者
6.  「**追加**」 をクリックします。
7.  フィールド名を上下にドラッグ アンド ドロップして、フィールドを並べ替えます。推奨される順序は次のとおりです。
    * コード、名前、建物、訪問者、スケジュールされた開始、スケジュールされた終了、実際の開始、実際の終了
8.  進行中の作業を保存するには、「**ファイル &#124; 保存**」 をクリックし、次に 「**保存**」 をクリックします 

## タスク 3: 訪問の編集フォームを構成します 

このタスクでは、個々の訪問レコードに関する情報を編集するフォームを構成します

1.  **ツリービュー**の下の **EditScreen1** を展開します
2.  **EditForm1** を選択します。
3.  「**作成した**フィールド」 を選択し、**Del** キーを押してフィールドを削除します
4.  プロパティ パネルで 「**フィールドの編集**」 を選択します。
5.  「**フィールドの追加**」 をクリックします。
6.  次のフィールドを選択します。
    * 建物 
    * 終了予定
    * 開始予定
    * 訪問者
7.  「**追加**」 をクリックします。
8.  フィールド名を上下にドラッグ アンド ドロップして、フィールドを並べ替えます。推奨される順序は次のとおりです。
    * 名前、建物、訪問者、スケジュールされた開始、スケジュールされた終了
9.  進行中の作業を保存するには、「**ファイル &#124; 保存**」 をクリックし、次に 「**保存**」 をクリックします 

タスク \#4: 訪問ギャラリーの構成
---------------------------------------

このタスクでは、事前に生成されたギャラリーを構成して、訪問のタイトル、開始日、終了日を表示します。 

1.  **ツリー ビュー**で **BrowseScreen1** を展開します
2.  **BrowseGallery1** を選択します
3.  プロパティ ドロップダウンから **TemplateSize** を選択します
4.  式を次の `Min(150, BrowseGallery1.Height - 60)` に置き換えます。これにより、追加情報を確保するのに十分なスペースが確保されます。
5.  ギャラリーの左上隅にある鉛筆アイコンを押してギャラリーを編集します
6.  日付と時刻のフィールドを選択する 
7.  「**テキスト**」 プロパティを `ThisItem.'Created On'` から `ThisItem.'Scheduled Start'` に変更します。
8.  フィールドをもう一度選択します。
9.  `Ctrl-C` を押してから `Ctrl-V` を押してフィールドのコピーを作成します。
10.  マウスまたはキーボードを使用して、コピーしたコントロールを下に移動し、ギャラリー内の他のコントロールに合わせます。
11.  **テキスト**プロパティを `ThisItem.' スケジュールされた終了` に変更します
12.  進行中の作業を保存するには、「**ファイル &#124; 保存**」 をクリックし、次に 「**保存**」 をクリックします 

## タスク #6: 日付フィルターの追加

訪問数は増加し続けるため、ユーザーは訪問ギャラリーをフィルタリングする機能が必要です。たとえば、ユーザーは今後の訪問のみを表示できます。このタスクでは、ユーザーが選択した日付の後にのみ訪問を表示する機能を追加します。

1. 「**挿入**」 メニューを選択します

2. 「**入力 &#124; 日付の選択**」 をクリックします 

3. キーボードまたはマウスを使用して、検索ボックスの下にコントロールを配置します。

4. **BrowseGallery1** を選択します 

5. ギャラリー コントロールのサイズを変更して移動し、日付の選択の下に配置し、画面を覆います。

6. **項目**プロパティ選択する

7. 式で `[@Visits]`を見つけて、`Filter(Visits,'Scheduled End' >= DatePicker1.SelectedDate)` に置き換えます。完全な式は次のようになります。

   ```
   SortByColumns(
   	Search(
        Filter(
        	Visits,
            'Scheduled End' >= DatePicker1.SelectedDate
           ),
           TextSearchBox1.Text,
       	"bc_code","bc_name"
       ),
     "bc_code",
     If(SortDescending1, Descending, Ascending)
   )
   ```
   
8. 進行中の作業を保存するには、「**ファイル &#124; 保存**」 をクリックし、次に 「**保存**」 をクリックします

# 演習 2: アプリの完成

この演習では、アプリケーションをテストし、成功したらソリューションに追加します。

タスク \#1: テスト アプリ
--------------------------

1.  アプリケーションを起動する

    -   **BrowseScreen1** を選択して **F5** キーを押すか、**アプリのプレビュー** をクリックします。
    -   アプリケーションが読み込まれ、訪問のリストが表示されます。 
    -   日付の選択コントロールで別の日付を選択してフィルターをテストする
    -   訪問を選択し、表示フォームが正しく動作していることを確認する
    -   ギャラリーに戻り、+ を押して新しい訪問を作成します。編集フォームに、訪問者、建物、およびスケジュールされた開始日と終了日などの必須フィールドが含まれていることを確認します。
    -   情報を入力して送信します。新しいレコードがギャラリーに表示されることを確認します。
    -   **Esc** キーを押してアプリを閉じます

2.  アプリケーションを保存して公開する

    -   **「ファイル」** をクリックしてから、**「保存」** をクリックします。

    -   発行をクリックします。

    -   この **「バージョンの発行」** をクリックします。

    -   「**閉じる**」 をクリックします。

    -   **デザイナー**のブラウザーの画面またはタブを閉じます。

    -   ブラウザーの画面を閉じようとしたときにメッセージが表示されたら、「**脱退**」をクリックします。

    -   前のウィンドウに戻り、「**完了**」 をクリックします。

## タスク #2: アプリをソリューションに追加して公開します 

1. 「Campus Management」 ソリューションを開きます。
   * <https://make.powerapps.com> にサインインします
   * **環境**を選択します
   * 「**ソリューション**」 を選択します。
   * 「**Campus Management**」 ソリューションをクリックして開きます。
2. 「**既存の | アプリ | キャンバス アプリの追加**」 を選択します。
3. 「**外部ソリューション**」 タブを選択します。
4. 「**キャンパス スタッフ**」 アプリを選択し、「**追加**」 をクリックします。
5. 「**キャンパス スタッフ**」 アプリを選択し、「**編集**」 をクリックします。
6. 「**ファイル | 公開**」 を選択します 

# 課題

* すべての訪問数のカレンダー ビューと日付範囲によるフィルタリング
* アプリの一部として連絡先を作成および管理する機能
* 1 回の訪問で複数の会議を表示する方法

